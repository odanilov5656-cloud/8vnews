<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç ‚Äî Daily News</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="container">
            <a href="index.html" style="color: white; text-decoration: none;"><h1>Daily News</h1></a>
            <nav>
                <ul>
                    <li><a href="index.html">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a></li>
                    <li><a href="#" onclick="logout()" style="color: #e74c3c;">–í—ã–π—Ç–∏</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="profile-box">
            <div class="avatar-big">üë§</div>
            
            <h2 id="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
            <p id="user-status">–°—Ç–∞—Ç—É—Å: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∞–≤—Ç–æ—Ä</p>
            
            <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">

            <div class="profile-actions">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h3>
                <a href="editor.html" class="btn-create">‚úç –ù–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç–∞—Ç—å—é</a>
            </div>

            <div class="profile-stats" style="margin-top: 30px; display: flex; justify-content: space-around;">
                <div>
                    <strong id="stat-articles">0</strong>
                    <p style="font-size: 12px; color: #888;">–°—Ç–∞—Ç–µ–π</p>
                </div>
                <div>
                    <strong>0</strong>
                    <p style="font-size: 12px; color: #888;">–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function initProfile() {
            const currentUser = localStorage.getItem('currentUser');

            // 1. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–æ—à–µ–ª, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
            if (!currentUser || currentUser === "null") {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.");
                window.location.href = 'login.html';
                return;
            }

            // 2. –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.getElementById('profile-name').innerText = currentUser;

            // 3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É, 
            // —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å—Ç–∞—Ç–µ–π
            loadUserStats(currentUser);
        }

        async function loadUserStats(username) {
            try {
                // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—å–∏ –∏–∑ –±–∞–∑—ã —á–µ—Ä–µ–∑ –Ω–∞—à Python-—Å–µ—Ä–≤–µ—Ä
                const response = await fetch('http://127.0.0.1:5000/get-articles');
                if (response.ok) {
                    const articles = await response.json();
                    // –§–∏–ª—å—Ç—Ä—É–µ–º —Å—Ç–∞—Ç—å–∏ —Ç–æ–ª—å–∫–æ —ç—Ç–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
                    const myArticles = articles.filter(a => a.author === username);
                    document.getElementById('stat-articles').innerText = myArticles.length;
                }
            } catch (e) {
                console.log("–°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω, —Å—Ç–∞—Ç–∏–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞");
            }
        }

        function logout() {
            // –£–¥–∞–ª—è–µ–º —Å–µ—Å—Å–∏—é
            localStorage.removeItem('currentUser');
            // –£—Ö–æ–¥–∏–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
            window.location.href = 'index.html';
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = initProfile;
    </script>

    <style>
        /* –î–æ–±–∞–≤–∏–º –Ω–µ–º–Ω–æ–≥–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Å—Ç–∏–ª–µ–π –ø—Ä—è–º–æ —Å—é–¥–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ */
        .btn-create {
            display: inline-block;
            background: #27ae60;
            color: white;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background 0.3s;
            margin-top: 10px;
        }

        .btn-create:hover {
            background: #219150;
        }

        .profile-box hr {
            opacity: 0.3;
        }
    </style>

</body>
</html>

