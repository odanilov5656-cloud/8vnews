async function publishPost() {
    const btn = document.getElementById('publish-btn');
    const author = localStorage.getItem('currentUser');

    if (!author) {
        alert("Пожалуйста, войдите в аккаунт!");
        return;
    }

    const title = document.getElementById('post-title').value;
    const content = document.getElementById('post-content').value;

    // Визуальный отклик
    btn.disabled = true;
    btn.innerText = "Связь с сервером (может занять до 1 мин)...";

    try {
        const response = await fetch('https://eightvnews.onrender.com/create-article', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                title: title,
                category: document.getElementById('post-category').value,
                content: content,
                author: author
            })
        });

        if (response.ok) {
            alert("Статья опубликована!");
            window.location.href = 'index.html';
        } else {
            alert("Сервер ответил ошибкой. Проверь логи на Render.");
        }
    } catch (error) {
        alert("Ошибка сети! Проверь интернет или подожди, пока сервер Render проснется.");
        console.error(error);
    } finally {
        btn.disabled = false;
        btn.innerText = "Опубликовать";
    }
}

