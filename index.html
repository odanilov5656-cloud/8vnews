<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily News ‚Äî –ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã, –ø–æ–∫–∞ –≥—Ä—É–∑–∏—Ç—Å—è style.css */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f9f9f9; margin: 0; }
        header { background: #1a1a1a; color: white; padding: 20px 0; text-align: center; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        .news-card { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status-error { color: #e74c3c; font-weight: bold; text-align: center; padding: 20px; }
        .btn-write { background: #3498db; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block; margin-bottom: 20px; }
    </style>
</head>
<body>

<header>
    <div class="container">
        <h1 style="font-family: 'Courier New', Courier, monospace; font-size: 40px; margin: 0;">Daily News</h1>
        <nav style="margin-top: 10px;">
            <a href="index.html" style="color: white; margin-right: 15px; text-decoration: none;">–ì–ª–∞–≤–Ω–∞—è</a>
            <span id="auth-link"></span>
        </nav>
    </div>
</header>

<main class="container">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h2>
        <a href="editor.html" class="btn-write">+ –ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç–∞—Ç—å—é</a>
    </div>

    <div id="loading-status" style="text-align: center; color: #666;">
        üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É... (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –¥–æ 1 –º–∏–Ω—É—Ç—ã)
    </div>

    <div id="news-list">
        </div>
</main>

<script>
    // –¢–≤–æ–π –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–∞ Render
    const API_URL = 'https://eightvnews.onrender.com';

    async function init() {
        updateUI();
        await fetchArticles();
    }

    // 1. –û–±–Ω–æ–≤–ª—è–µ–º —à–∞–ø–∫—É (–∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
    function updateUI() {
        const user = localStorage.getItem('currentUser');
        const authContainer = document.getElementById('auth-link');
        
        if (user) {
            authContainer.innerHTML = `<a href="profile.html" style="color: #3498db; text-decoration: none;">üë§ ${user}</a>`;
        } else {
            authContainer.innerHTML = `<a href="login.html" style="color: white; text-decoration: none;">–í–æ–π—Ç–∏</a>`;
        }
    }

    // 2. –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–µ–π
    async function fetchArticles() {
        const newsList = document.getElementById('news-list');
        const status = document.getElementById('loading-status');

        try {
            const response = await fetch(`${API_URL}/get-articles`);
            
            if (!response.ok) throw new Error("–°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª –æ—à–∏–±–∫–æ–π");

            const articles = await response.json();
            status.style.display = 'none';

            if (articles.length === 0) {
                newsList.innerHTML = "<p style='text-align:center;'>–°—Ç–∞—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>";
                return;
            }

            // –í—ã–≤–æ–¥–∏–º —Å—Ç–∞—Ç—å–∏ (—Å–∞–º—ã–µ –Ω–æ–≤—ã–µ –≤–≤–µ—Ä—Ö—É)
            newsList.innerHTML = articles.reverse().map(art => `
                <div class="news-card">
                    <small style="color: #3498db; text-transform: uppercase;">${art.category || '–û–±—â–µ–µ'}</small>
                    <h2 style="margin: 10px 0;">${art.title}</h2>
                    <p style="color: #777; font-size: 14px;">–ê–≤—Ç–æ—Ä: <b>${art.author}</b></p>
                    <a href="article.html?id=${art.id}" style="color: #e67e22; font-weight: bold; text-decoration: none;">–ß–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é ‚Üí</a>
                </div>
            `).join('');

        } catch (error) {
            console.error("–û—à–∏–±–∫–∞:", error);
            status.innerHTML = `
                <div class="status-error">
                    –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É!<br>
                    <span style="font-weight: normal; font-size: 14px; color: #666;">
                        –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Å–µ—Ä–≤–µ—Ä Render "—Å–ø–∏—Ç". –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.
                    </span><br>
                    <button onclick="location.reload()" style="margin-top:15px; padding: 10px;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å</button>
                </div>
            `;
        }
    }

    window.onload = init;
</script>

</body>
</html>
