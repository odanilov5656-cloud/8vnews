<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8V News ‚Äî –ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π */
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .news-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .news-card:hover {
            transform: translateY(-5px);
        }
        .category-badge {
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            text-transform: uppercase;
        }
        .read-more-btn {
            display: inline-block;
            margin-top: 15px;
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
        }
        #loading-status {
            text-align: center;
            padding: 20px;
            color: #666;
        }
    </style>
</head>
<body>

    <header>
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <a href="index.html" style="text-decoration: none; color: white;"><h1>8V News</h1></a>
            <nav>
                <ul id="nav-menu" style="list-style: none; display: flex; gap: 20px;">
                    <li><a href="index.html" style="color: white; text-decoration: none;">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li id="user-link"><a href="login.html" style="color: white; text-decoration: none;">–í–æ–π—Ç–∏</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <h2 style="margin-top: 30px;">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h2>
        
        <div id="loading-status">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —Å —Å–µ—Ä–≤–µ—Ä–∞...</div>
        
        <div id="news-container" class="news-grid">
            </div>
    </main>

    <script>
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Ç–≤–æ–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ Render
        const API_URL = 'https://eightvnews.onrender.com';

        async function initPage() {
            updateAuthUI();
            await loadArticles();
        }

        // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        function updateAuthUI() {
            const user = localStorage.getItem('currentUser');
            const userLink = document.getElementById('user-link');
            
            if (user && user !== "null") {
                userLink.innerHTML = `<a href="profile.html" style="color: #f1c40f; text-decoration: none;">üë§ ${user}</a>`;
            }
        }

        // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç—å–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        async function loadArticles() {
            const container = document.getElementById('news-container');
            const status = document.getElementById('loading-status');

            try {
                // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ —Ç–≤–æ–µ–º—É –±—ç–∫–µ–Ω–¥—É
                const response = await fetch(`${API_URL}/get-articles`);
                
                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');

                const articles = await response.json();
                status.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å –∑–∞–≥—Ä—É–∑–∫–∏

                if (articles.length === 0) {
                    container.innerHTML = "<p>–ù–æ–≤–æ—Å—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç. –°—Ç–∞–Ω—å—Ç–µ –ø–µ—Ä–≤—ã–º –∞–≤—Ç–æ—Ä–æ–º!</p>";
                    return;
                }

                // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∂–¥—É—é —Å—Ç–∞—Ç—å—é
                container.innerHTML = articles.map(art => `
                    <article class="news-card">
                        <span class="category-badge">${art.category || '–û–±—â–µ–µ'}</span>
                        <h3 style="margin: 15px 0 10px 0;">${art.title}</h3>
                        <p style="color: #666; font-size: 14px;">–ê–≤—Ç–æ—Ä: <strong>${art.author}</strong></p>
                        <a href="article.html?id=${art.id}" class="read-more-btn">–ß–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é ‚Üí</a>
                    </article>
                `).join('');

            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                status.innerHTML = `<b style="color: red;">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏.</b><br>
                –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ (—Å–µ—Ä–≤–µ—Ä Render –º–æ–∂–µ—Ç –ø—Ä–æ—Å—ã–ø–∞—Ç—å—Å—è).`;
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = initPage;
    </script>
</body>
</html>

